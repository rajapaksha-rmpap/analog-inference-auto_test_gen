# Assembler for Chip - Input Processor 
# Input uP Assembly Code 
0:MOV,r448,1 # # Init process count 
1:MOV,r449,0 ## Initialize current process id
2:MOV,r492,1 # 
3:LLSHIFT,r492,r492,23 # 
4:MOV,r471,9 # # Initialize base address offset reg
5:MOV,r480,1040 # 
6:OR,r480,r476,r492 # # Initialize Output Buffer status reg
7:MOV,r480,1024 # 
8:OR,r480,r475,r492 # # Initialize Input buffer status address reg
9:MOV,r480,4108 # 
10:OR,r480,r478,r492 # # Initialize Input dma busy address reg
11:MOV,r480,4104 # 
12:OR,r480,r479,r492 # # Initialize Input DMA enable address reg
13:MOV,r468,0 ## Initialize image end status reg
14:MOV,r470,0 ## Initialize context switch reg
15:MOV,r450,25 # # store proc0 start loc
16:MOV,r460,25 # # store proc0 last loc  
17:NOP #
18:NOP #
19:NOP #
20:NOP #
21:NOP #
22:NOP #
23:NOP #
24:NOP #
25:NOP #
26:NOP #
27:NOP #
28:NOP #
29:NOP #
30:NOP #
31:MOV,r449,0 ## curr proc id
# Switch to proc id
32:ADDI,r449,r510,0 # 
33:SUBI,r510,r510,0 # 
34:BRANZ,2 # 
35:BRAREG,r460 ## branch to counter proc 0 
36:SUBI,r510,r510,1 # 
37:BRANZ,2 # 
38:BRAREG,r461 ## branch to counter proc 1 
39:SUBI,r510,r510,1 # 
40:BRANZ,2 # 
41:BRAREG,r462 ## branch to counter proc 2 
42:SUBI,r510,r510,1 # 
43:BRANZ,2 # 
44:BRAREG,r463 ## branch to counter proc 3 
45:SUBI,r510,r510,1 # 
46:BRANZ,2 # 
47:BRAREG,r464 ## branch to counter proc 4 
48:SUBI,r510,r510,1 # 
49:BRANZ,2 # 
50:BRAREG,r465 ## branch to counter proc 5 
51:SUBI,r510,r510,1 # 
52:BRANZ,2 # 
53:BRAREG,r466 ## branch to counter proc 6 
54:SUBI,r510,r510,1 # 
55:BRANZ,2 # 
56:BRAREG,r467 ## branch to counter proc 7 
# Entry point for context switch
57:SUB,r448,r510,r449 # 
58:BRANZ,-26 # 
59:BRAUNCOND,-28 # 
# Layer Instruction Start
60:MOV,r36,0 # 
61:MOV,r480,0 # 
62:LLSHIFT,r480,r480,16 # 
63:OR,r36,r36,r480 # 
64:ADDI,r36,r1,0 # 
65:MOV,r486,2016 # 
66:SUB,r1,r1,r486 # 
67:MOV,r48,0 # 
68:MOV,r480,144 # 
69:LLSHIFT,r480,r480,16 # 
70:OR,r48,r48,r480 # 
71:MOV,r0,-3 # 
72:MOV,r37,0 # 
73:MOV,r477,4104 # 
74:MOV,r480,128 # 
75:LLSHIFT,r480,r480,16 # 
76:OR,r477,r477,r480 # 
77:MOV,r40,5120 # 
78:MOV,r480,128 # 
79:LLSHIFT,r480,r480,16 # 
80:OR,r40,r40,r480 # 
81:MOV,r56,4864 # 
82:MOV,r480,128 # 
83:LLSHIFT,r480,r480,16 # 
84:OR,r56,r56,r480 # 
85:MOV,r49,16383 # 
86:MOV,r50,0 # 
87:MOV,r2,0 # 
88:MOV,r58,0 # 
89:MOV,r60,96 # 
90:MOV,r35,0 # 
91:MOV,r480,0 # 
92:LLSHIFT,r480,r480,16 # 
93:OR,r35,r35,r480 # 
94:ADDI,r56,r480,0 ## Start SET_LYR_REG 
95:ADDI,r49,r482,0 # 
96:ADDI,r480,r483,0 # 
97:LLSHIFT,r482,r482,0 # 
98:STORE,r483,r482 # 
99:LLSHIFT,r48,r482,0 # 
100:ADDI,r480,r483,4 # 
101:STORE,r483,r482 # 
102:ADDI,r35,r482,0 # 
103:ADDI,r480,r483,12 # 
104:STORE,r483,r482 # 
105:LLSHIFT,r58,r482,16 # 
106:OR,r482,r482,r60 # 
107:ADDI,r480,r483,8 # 
108:STORE,r483,r482 ## end SET_LYR_REG 
109:SUBI,r2,r2,0 # 
110:BRAZ,5 # 
111:ADDI,r40,r40,128 # 
112:SUBI,r2,r2,1 # 
113:BRALEZ,2 # 
114:BRAUNCOND,-3 # 
115:MOV,r35,0 # 
116:MOV,r52,16777215 # 
117:MOV,r2,0 # 
118:MOV,r3,0 # 
119:ADDI,r0,r4,0 # 
120:ADDI,r4,r4,7 # 
121:ADDI,r4,r5,0 # 
122:SUBI,r5,r5,224 # 
123:BRALEZ,2 # 
124:MOV,r4,224 # 
125:ADDI,r4,r6,0 # 
126:SUB,r6,r6,r2 # 
127:MOV,r27,1 # 
128:MOV,r28,1088 # 
129:MOV,r32,1 # 
130:OR,r28,r482,r492 #  # Start START_TFR_REG_XBARS 
131:ADDI,r482,r480,80 # 
132:STORE,r480,r6 # # End START_TFR_REG_XBARS
133:MOV,r32,-9 # 
134:MOV,r5,0 # 
135:MOV,r6,4 # 
136:MOV,r7,4 # 
137:MOV,r53,15 # 
138:MOV,r8,6 # 
139:SUB,r8,r8,r5 # 
140:BRANZ,4 # 
141:MOV,r6,4 # 
142:MOV,r7,4 # 
143:MOV,r53,15 # 
144:MOV,r480,4128 # 
145:OR,r480,r480,r492 # 
146:LOAD,r480,r481 # #read  split_grp_reg
147:OR,r481,r481,r35 # 
148:STORE,r480,r481 # #write to split_grp_reg
149:ADDI,r40,r480,0 # 
150:ADDI,r7,r485,0 # 
151:ADDI,r480,r481,0 # 
152:MOV,r482,1 # 
153:LLSHIFT,r482,r482,16 # 
154:ADDI,r7,r483,0 # 
155:OR,r482,r482,r483 # 
156:STORE,r481,r482 ##write to bt_size_reg 
157:ADDI,r480,r481,20 # 
158:ADDI,r7,r482,0 # 
159:STORE,r481,r482 # #write to mb_config_reg
160:ADDI,r480,r481,28 # 
161:LLSHIFT,r7,r482,31 # 
162:OR,r482,r482,r7 # 
163:STORE,r481,r482 # #write to row_step_reg
164:ADDI,r480,r480,128 # 
165:SUBI,r485,r485,1 # 
166:BRALEZ,2 # 
167:BRAUNCOND,-16 # #End SET_NXBARS_REG
168:ADDI,r40,r41,0 # 
169:MOV,r9,0 # 
170:MOV,r10,4 # 
171:MOV,r11,39 # 
172:MOV,r13,24 # 
173:ADDI,r7,r4,0 # 
174:SUBI,r4,r4,1 # 
175:SUB,r4,r4,r9 # 
176:BRANZ,6 # 
177:SUBI,r8,r8,0 # 
178:BRANZ,4 # 
179:MOV,r10,4 # 
180:MOV,r11,39 # 
181:MOV,r13,24 # 
182:MOV,r12,0 # 
183:MOV,r14,0 # 
184:ADDI,r32,r15,0 # 
185:MOV,r16,0 # 
186:MOV,r17,0 # 
187:MOV,r18,0 # 
188:ADDI,r1,r19,0 # 
189:MOV,r43,0 # 
190:MOV,r44,0 # 
191:ADDI,r41,r42,0 # 
192:MOV,r20,0 # 
193:MOV,r33,0 # 
194:ADDI,r15,r21,0 # 
195:ADDI,r0,r22,0 # 
196:ADD,r22,r22,r33 # 
197:BRAGEZ,2 # 
198:BRAUNCOND,3 # 
199:SUBI,r22,r22,223 # 
200:BRALEZ,3 # 
201:MOV,r21,0 # 
202:SUB,r21,r21,r11 # 
203:ADDI,r11,r22,0 # 
204:ADDI,r16,r25,0 # 
205:SUBI,r22,r22,0 # 
206:BRALEZ,118 # 
207:ADDI,r22,r23,0 # 
208:ADDI,r17,r24,0 # 
209:ADDI,r25,r34,0 # 
210:SUB,r34,r34,r18 # 
211:ADDI,r42,r46,0 # 
212:ADDI,r44,r47,0 # 
213:ADDI,r18,r26,0 # 
214:MOV,r486,2048 # 
215:ADD,r26,r26,r486 # 
216:SUB,r26,r26,r25 # 
217:ADDI,r26,r4,0 # 
218:SUB,r26,r26,r22 # 
219:BRAGEZ,10 # 
220:ADDI,r4,r23,0 # 
221:MOV,r486,2048 # 
222:ADD,r18,r18,r486 # 
223:ADDI,r17,r17,1 # 
224:ADDI,r42,r42,128 # 
225:ADDI,r43,r44,0 # 
226:SUBI,r23,r23,0 # 
227:BRALEZ,2 # 
228:ADDI,r44,r44,8 # 
229:MOV,r27,0 # 
230:SUBI,r21,r21,0 # 
231:BRAGEZ,7 # 
232:MOV,r27,0 # 
233:SUB,r27,r27,r21 # 
234:ADDI,r27,r4,0 # 
235:SUB,r4,r4,r23 # 
236:BRALEZ,2 # 
237:ADDI,r23,r27,0 # 
238:ADDI,r23,r28,0 # 
239:SUB,r28,r28,r27 # 
240:MOV,r29,0 # 
241:ADDI,r21,r4,0 # 
242:ADDI,r4,r4,0 # 
243:ADD,r4,r4,r23 # 
244:SUBI,r4,r4,672 # 
245:BRALEZ,2 # 
246:ADDI,r4,r29,0 # 
247:SUB,r28,r28,r29 # 
248:ADDI,r19,r30,0 # 
249:ADDI,r30,r30,0 # 
250:ADDI,r21,r4,0 # 
251:SUBI,r4,r4,0 # 
252:BRAGEZ,2 # 
253:BRAUNCOND,5 # 
254:SUBI,r4,r4,672 # 
255:BRALEZ,2 # 
256:BRAUNCOND,2 # 
257:ADD,r30,r30,r21 # 
258:ADDI,r28,r4,0 # 
259:ADD,r4,r4,r27 # 
260:ADD,r4,r4,r29 # 
261:BRALEZ,59 # 
262:ADDI,r9,r31,0 # 
263:ADD,r31,r31,r14 # 
264:ADD,r31,r31,r24 # 
265:ADDI,r43,r45,0 # 
266:SUB,r45,r45,r47 # 
267:ADDI,r46,r480,0 ## Start MOV_TO_XBAR_NEW 
268:OR,r480,r480,r492 # 
269:MOV,r485,1 # 
270:LLSHIFTREG,r485,r485,r31 # 
271:AND,r52,r485,r485 # 
272:BRAZ,48 # 
273:ADDI,r480,r481,20 # 
274:ADDI,r449,r482,0 # 
275:STORE,r481,r482 # 
276:ADDI,r480,r486,32 # 
277:ADD,r486,r486,r45 # 
278:MOV,r482,0 # 
279:MOV,r483,0 # 
280:MOV,r484,0 # 
281:ADDI,r28,r481,0 # 
282:BRANZ,2 # 
283:MOV,r484,1 # 
284:ADDI,r27,r481,0 # 
285:BRAZ,3 # 
286:ADDI,r482,r482,1 # 
287:ADDI,r27,r483,0 # 
288:ADDI,r29,r481,0 # 
289:BRAZ,3 # 
290:ADDI,r482,r482,2 # 
291:ADDI,r29,r483,0 # 
292:MOV,r485,1 # 
293:LLSHIFT,r484,r484,1 # 
294:OR,r485,r485,r484 # 
295:LLSHIFT,r482,r482,2 # 
296:OR,r485,r485,r482 # 
297:LLSHIFT,r483,r483,4 # 
298:OR,r485,r485,r483 # 
299:LLSHIFT,r28,r484,16 # 
300:OR,r485,r485,r484 # 
301:STORE,r486,r485 # # write to cmd_wd0_Reg 
302:ADDI,r30,r485,0 # 
303:BRAGEZ,2 # 
304:MOV,r485,0 # 
305:ADD,r30,r485,r48 # 
306:ADDI,r34,r482,31 # 
307:LRSHIFT,r482,r482,5 # 
308:LLSHIFT,r482,r482,25 # 
309:OR,r485,r485,r482 # 
310:ADDI,r486,r486,4 # 
311:STORE,r486,r485 ##write to cmd_wd1_reg 
312:ADDI,r480,r480,0 # 
313:MOV,r481,1 # 
314:LLSHIFT,r481,r481,16 # 
315:ADD,r28,r482,r27 # 
316:ADD,r482,r482,r29 # 
317:OR,r482,r481,r481 # 
318:STORE,r480,r481 ## write to bt_size_reg - End MOV_TO_XBAR_NEW 
319:ADDI,r43,r43,8 # 
320:ADD,r21,r21,r23 # 
321:ADD,r25,r25,r23 # 
322:SUB,r22,r22,r23 # 
323:BRAUNCOND,-118 # 
324:ADDI,r19,r19,672 # 
325:ADDI,r16,r16,64 # 
326:ADDI,r33,r33,1 # 
327:ADDI,r20,r20,1 # 
328:MOV,r4,7 # 
329:SUB,r4,r4,r20 # 
330:BRALEZ,2 # 
331:BRAUNCOND,-137 # 
332:ADDI,r14,r14,1 # 
333:ADDI,r12,r12,1 # 
334:ADDI,r41,r41,128 # 
335:MOV,r4,1 # 
336:SUB,r4,r4,r12 # 
337:BRALEZ,2 # 
338:BRAUNCOND,-154 # 
339:ADD,r32,r32,r13 # 
340:ADDI,r9,r9,1 # 
341:ADDI,r7,r4,0 # 
342:SUB,r4,r4,r9 # 
343:BRALEZ,2 # 
344:BRAUNCOND,-174 # 
345:LOAD,r479,r482 ## Start MULTI_END_BLOCK - Read input_cmd_list_en_reg
346:NOT,r53,r483 # 
347:AND,r483,r483,r482 # 
348:STORE,r479,r483 ## Write to input_cmd_list_en_reg 
349:OR,r53,r481,r482 # 
350:STORE,r479,r481 ## Write to input_cmd_list_en_reg - End MULTI_END_BLOCK 
351:NOP # # Start MULTI_END_SYNC
352:NOP # 
353:NOP # 
354:NOP # 
355:HALT # 
356:NOP # 
357:LOAD,r478,r483 # # read input_dma_busy_reg 
358:AND,r483,r483,r53 # 
359:BRAZ,4 # 
360:MOV,r460,316 # 
361:MOV,r449,1 # 
362:BRAUNCOND,-305 ##  End MULTI_END_SYNC 
363:ADDI,r5,r5,1 # 
364:MOV,r4,7 # 
365:SUB,r4,r4,r5 # 
366:BRALEZ,2 # 
367:BRAUNCOND,-232 # 
368:ADDI,r0,r0,2 # 
369:MOV,r27,0 # 
370:SUBI,r0,r0,0 # 
371:BRALEZ,29 # 
372:ADDI,r0,r27,0 # 
373:ADDI,r0,r4,0 # 
374:SUBI,r4,r4,2 # 
375:BRALEZ,2 # 
376:MOV,r27,2 # 
377:MOV,r28,1 # 
378:MOV,r29,1088 # 
379:ADDI,r29,r480,88 ## Start CHECK_FIFO_REG 
380:OR,r480,r480,r492 # 
381:LOAD,r480,r481 ##read in_buf_cntr_reg 
382:SUB,r481,r481,r27 # 
383:BRAGEZ,2 # 
384:BRAUNCOND,-3 # # End CHECK_FIFO_REG 
385:MOV,r29,1172 # 
386:ADDI,r27,r4,0 # 
387:MOV,r20,1 # 
388:OR,r29,r480,r492 ## Start  POP_REG 
389:MOV,r481,1 # 
390:STORE,r480,r481 ## write to asq_send_reg 
391:MOV,r481,1028 # 
392:OR,r481,r481,r492 # 
393:STORE,r481,r28 ## write to in_buf_decr_reg- End POP_REG 
394:MOV,r481,1032 ## Start SEND_SYNC_PREV 
395:OR,r481,r481,r492 # 
396:STORE,r481,r28 # # End SEND_SYNC_PREV
397:SUBI,r4,r4,1 # 
398:BRALEZ,2 # 
399:BRAUNCOND,-11 # 
400:ADD,r2,r2,r27 # 
401:MOV,r486,1344 # 
402:ADD,r1,r1,r486 # 
403:ADDI,r3,r3,1 # 
404:MOV,r4,112 # 
405:SUB,r4,r4,r3 # 
406:BRALEZ,2 # 
407:BRAUNCOND,-288 # 
408:MOV,r28,1 # 
409:MOV,r2,3 # 
410:MOV,r9,19456 # 
411:MOV,r480,2 # 
412:LLSHIFT,r480,r480,16 # 
413:OR,r9,r9,r480 # 
414:ADD,r36,r36,r9 # 
415:MOV,r30,1192 # 
416:MOV,r31,1176 # 
417:NOP #  # Start SET_UP_NEXT 
418:SUBI,r2,r486,0 # 
419:BRAZ,16 # 
420:OR,r31,r480,r492 # 
421:LOAD,r480,r481 ##read input_buf_cnt_reg 
422:SUB,r481,r481,r2 # 
423:BRAGEZ,4 # 
424:MOV,r460,385 # 
425:MOV,r449,1 # 
426:BRAUNCOND,-369 # 
427:MOV,r481,1032 # 
428:OR,r481,r481,r492 # 
429:MOV,r483,1028 # 
430:OR,r483,r483,r492 # 
431:STORE,r481,r28 ## write to asq_send_reg 
432:STORE,r483,r28 ## write to ib_decr_reg 
433:SUBI,r2,r2,1 # 
434:BRANZ,-3 # 
435:MOV,r460,29 # 
436:MOV,r449,0 # 
437:BRAUNCOND,-380 # #Branch to the same layer, instruction start location
438:NOP # 
439:NOP # 
440:NOP # 
441:NOP # 
442:NOP # 
443:HALT # 
444:NOP ##End SET_UP_NEXT 
